{% extends "base.html" %}

{% block content %}
<!-- Update title -->
<title>Lifeline - Dashboard</title>
<!-- Update any website name references -->
<div class="logo-text"></div>

<!-- Stats Overview with enhanced styling -->
<div class="stats-overview">
    <div class="stat-card">
        <div class="stat-icon">
            <i class="fas fa-coins"></i>
        </div>
        <div class="stat-info">
            <h3 id="supportQuota">{{ stats.support_quota }}%</h3>
            <p>Support Quota ({{ stats.trust_level }})</p>
            
        </div>
    </div>

    <div class="stat-card">
        <div class="stat-icon">
            <i class="fas fa-hand-holding-heart"></i>
        </div>
        <div class="stat-info">
            <h3 id="peopleHelpedCount">{{ stats.people_helped }}</h3>
            <p>People Helped</p>
        </div>
    </div>
</div>

<!-- Main Grid -->
<div class="main-grid">
    <div class="campaign-section">
        <div class="section-header">
            <div class="header-left">
                <h2>Live Campaigns</h2>
                <span class="live-indicator">Live</span>
            </div>
            <div class="feed-filters">
                <button class="filter-btn active" data-filter="for-you">For You</button>
            </div>
        </div>

        <div class="help-requests-feed">
            {% for campaign in recent_campaigns %}
            <div class="request-card">
                <div class="user-info">
                    <div class="user-info-left">
                        <!-- Profile Picture - Updated with link -->
                        {% if campaign.user_id %}
                            <a href="{{ url_for('view_user_profile', username=campaign.username) }}" class="profile-link">
                                <img src="{{ url_for('get_profile_picture', user_id=campaign.user_id) }}" 
                                     alt="Profile picture" 
                                     class="user-avatar">
                            </a>
                        {% else %}
                            <div class="user-avatar">{{ campaign.name[0]|upper }}</div>
                        {% endif %}
                        
                        <div class="user-details">
                            <h4>{{ campaign.name }} <span class="dot">â€¢</span> <span class="timestamp">{{ campaign.time }}</span></h4>
                        </div>
                    </div>
                </div>
                <p class="request-text">{{ campaign.title }}</p>
           
        
                
                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress" style="width: {{ campaign.progress }}%"></div>
                    </div>
                    <div class="progress-stats">
                        <span class="amount-raised">${{ '{:,.2f}'.format(campaign.amount_raised) }} raised</span>
                        <span class="goal-amount">of ${{ '{:,.2f}'.format(campaign.goal_amount) }}</span>
                    </div>
                </div>

                <div class="request-actions">
                    <div class="left-actions">
                        <a href="{{ url_for('campaign_detail', campaign_id=campaign.id) }}" class="action-btn view-btn small">
                            <i class="fas fa-eye"></i>
                            View
                        </a>
                    </div>
                    <div class="right-actions">
                        <a href="{{ url_for('donate', campaign_id=campaign.id) }}" class="help-btn">
                            <i class="fas fa-hand-holding-heart"></i>
                            Help
                        </a>
                        <button class="action-btn share-btn" onclick="shareCampaign('{{ campaign.id }}', '{{ campaign.title }}')">
                            <i class="fas fa-share-alt"></i>
                            Share
                        </button>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</div>
